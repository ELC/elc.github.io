<!DOCTYPE html>

<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Lyrics Presentation Generator 	&#124; Ezequiel Leonardo Castaño Personal Website</title>

    <!-- Meta -->
    <meta name="name" content="Ezequiel Leonardo Castaño Personal Website">
    <meta name="description" content="Ezequiel Leonardo Castaño Personal Website - In this website you will find post about christianity, programming and math">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta name="image" content="https://elc.github.io/blog/images/online-lyrics/online-lyrics-headerimage.png">    

    <!-- Google Verification -->
    <meta name="google-site-verification" content="UKZ1mYz9vI6xkYtBnIQL-cjCusUxX-2fKT7wdtJEdZU" />

    <!-- Social -->
      <meta property="article:author" content="Ezequiel Leonardo Castaño" />
      <meta property="article:section" content="Christianity" />
      <meta property="article:published_time" content="2019-05-22" />

      <meta property="og:type" content="article"/>
      <meta property="og:title" content="Lyrics Presentation Generator"/>
      <meta property="og:description" content="More often than not I find myself writing power point presentations for Lyrics. This usually happens in the youth service at church and in christian camps. Since the process is quite repetitive and simple enough I consider developing a web app to generate this presentations automatically. In this article I will show it how it works and how to use it."/>
      <meta property="og:site_name" content="Ezequiel Leonardo Castaño Personal Website" />
      <meta property="og:url" content="https://elc.github.io/posts/online-lyrics-presentation-generator/"/>
      <meta property="og:image" content="https://elc.github.io/blog/images/online-lyrics/online-lyrics-headerimage.png"/>

      <meta name="twitter:card" content="summary">
      <meta name="twitter:title" content="Lyrics Presentation Generator">
      <meta name="twitter:description" content="More often than not I find myself writing power point presentations for Lyrics. This usually happens in the youth service at church and in christian camps. Since the process is quite repetitive and simple enough I consider developing a web app to generate this presentations automatically. In this article I will show it how it works and how to use it.">
      <meta name="twitter:url" content="https://elc.github.io/posts/online-lyrics-presentation-generator/">
      <meta name="twitter:image" content="https://elc.github.io/blog/images/online-lyrics/online-lyrics-headerimage.png">
    

    <!-- Feed -->
      <link rel="alternate" type="application/atom+xml" href="http://feeds.feedburner.com/ELCWEB" title="Ezequiel Leonardo Castaño Personal Website Atom Feed" />
      <link rel="alternate" type="application/atom+xml" href="http://feeds.feedburner.com/feeds/all.atom.xml" title="Ezequiel Leonardo Castaño Personal Website Atom Feed" />

    <!-- Comments -->

      <link rel="alternate" type="application/rss+xml" href="http://elcgweb.disqus.com/latest.rss" title="Ezequiel Leonardo Castaño Personal Website Comments RSS Feed">

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="https://elc.github.io/theme/css/style.css?v=1dc05de">

    <!-- Fonts -->
    <script src="https://use.fontawesome.com/6af5d1a69f.js" async></script>

    <!-- Localization -->
    <link rel="prefetch" type="application/l10n" href="https://elc.github.io/localization.ini" />

    <!-- FAVICON -->
    <link rel="apple-touch-icon" sizes="180x180" href="https://elc.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://elc.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://elc.github.io/favicon-16x16.png">
    <link rel="manifest" href="https://elc.github.io/site.webmanifest">
    <link rel="mask-icon" href="https://elc.github.io/safari-pinned-tab.svg" color="#000000">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="theme-color" content="#ffffff">

    
  </head>

  <body>

    <a id="topbar"></a>

<nav class="nav-bar">
    <h1><a href="https://elc.github.io" class="logo" title="Home">EL</a></h1>
    <input class="nav-menu-btn" type="checkbox" id="nav-menu-btn" />
    <label class="nav-menu-icon" for="nav-menu-btn"><span class="nav-icon"></span></label>
    <ul class="nav-menu">
        <li class="nav-menu__entry" ><a href="https://elc.github.io">Home</a></li>
                <li class="nav-menu__entry" ><a href="https://elc.github.io/about/" data-l10n-id="about">about</a></li>
                <li class="nav-menu__entry" ><a href="https://elc.github.io/projects/" data-l10n-id="portfolio">portfolio</a></li>
                <li class="nav-menu__entry" ><a href="https://elc.github.io/publications.html" data-l10n-id="publications">publications</a></li>
    </ul>
</nav>
<div class="nav-separator"></div>
  
    <aside class="ethical">
    <div>
      <div data-ea-keywords=Christian|WebApp|Presentation|Lyrics></div>
    </div>
    </aside>



<article class="article">

  <header class="article__header">
    <h1>Lyrics Presentation Generator</h1>
    
<div class="article__subheader">

    <!-- Metadata -->
    <div class="article__metadata">
        <div class="article__metadata-item">
            <time datetime="2019-05-22 00:00:00-03:00"><b>22 May 2019</b></time>
        </div>
    
        <!-- Time to Read -->
            <div class="article__metadata-item">
                <b>5 min <span data-l10n-id="to-read">to read</span></b>
            </div>
            
    </div>

</div>

<!-- Translations -->
<div class="article__translations">


                      <span data-l10n-id="also-translated">Also Translated in: </span>
                        <a href="https://elc.github.io/posts/online-lyrics-presentation-generator/es/">Español </a>  

</div>  </header>


  <section>
    <!-- Status: draft -->

<p><a class="gallery" href="/blog/images/online-lyrics/online-lyrics-headerimage.png"><img alt="Online Lyrics Presentation Generator Header Image" class="b-lazy" data-src="/blog/images/online-lyrics/online-lyrics-headerimage.png" src="https://elc.github.io/blog/images/online-lyrics/online-lyrics-headerimage-thumbnail.png" width="1920"></a></p>


<p>More often than not I find myself writing power point presentations for Lyrics. This usually happens in the youth service at church and in christian camps. Since the process is quite repetitive and simple enough I consider developing a web app to generate this presentations automatically. In this article I will show it how it works and how to use it.</p>


<h2 id="the-problem"><a class="toclink" href="#the-problem">The Problem</a></h2>
<p>As said in the introduction the problem is basically, avoid writing over an over the presentation for the lyrics</p>
<h2 id="the-solution"><a class="toclink" href="#the-solution">The Solution</a></h2>
<p>Developing a Web App to automatically generate the power point presentation. This app doesn't require any installation and will work from any browser, but for a better user experience it is recommended to use from a desktop/tablet environment. In this article, I will dedicate the next section to explain how to use it for non-technical users and then I will explain all its components from a technical perspective</p>
<p>Note: I understand the importance of responsive design but to in this case in order to produce a presentation that match the text, bigger dimensions than the usual cellphone provides are needed. Besides, it is unlikely that the user will download the presentation from a mobile device.</p>
<h2 id="how-to-use-it"><a class="toclink" href="#how-to-use-it">How to use it</a></h2>
<p>The app is available <a href="https://elc.github.io/link/lyrics_presentation" target="_blank">online</a>, as soon as you open it, you will see something like the following:</p>
<p><a class="gallery" href="/blog/images/online-lyrics/tutorial.png"><img alt="image alt text" class="b-lazy" data-src="/blog/images/online-lyrics/tutorial.png" src="https://elc.github.io/blog/images/online-lyrics/tutorial-thumbnail.png" width="1245"></a></p>
<p>In the screen there are 3 main areas:</p>
<ul>
<li><strong>Lyrics Area</strong>: is the area marked in <strong>orange</strong>, this is where the text of the lyrics will be written. To properly write the lyrics, one should follow the instructions (see below).</li>
<li><strong>Language Selection</strong>: In the top right corner, there are two flags marked with <strong>green</strong>, each flag changes the language of the whole page.</li>
<li><strong>Buttons</strong>: This area is marked with <strong>purple</strong>, it includes two buttons, one for generating the presentation and the other to clear the text area.</li>
</ul>
<h3 id="instructions-for-writing-the-lyrics"><a class="toclink" href="#instructions-for-writing-the-lyrics">Instructions for writing the lyrics</a></h3>
<p>In order to write the lyrics, the following guide should be followed:</p>
<ul>
<li>Write each Verse with no blank lines in between.</li>
<li>Separate Verses with blank lines.</li>
<li>Separate Songs with three dashes, "---".</li>
</ul>
<p>The size of the Lyrics Area is set to match the resulting presentation so if the text fits well in the web page, it will fit in the presentation as well.</p>
<h2 id="how-it-works-technical"><a class="toclink" href="#how-it-works-technical">How it works (Technical)</a></h2>
<p>This web app is built using vanilla <code>HTML5</code>, <code>CSS3</code> and <code>Javascript</code>. Additionally, a <code>Javascript</code> library is used for creating the presentation, this library is <a href="https://github.com/gitbrent/PptxGenJS" target="_blank"><strong>PptxGenJS</strong></a>.</p>
<p>The <code>CSS</code> is written inside the <code>HTML</code> to avoid using another request, this is done because the whole style is about 100 lines and the whole app is contained in a single html file. The <code>Javascript</code> is separated to keep logic and presentation layers separated.</p>
<p>First I will show all the code and then split it into pieces and explain part by part</p>
<p>The <code>Javascript</code> code to achieved this is the following:</p>
<div class="highlight "><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">createPPT</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">pptx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">PptxGenJS</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="nx">pptx</span><span class="p">.</span><span class="nx">setTitle</span><span class="p">(</span><span class="s2">&quot;Presentation created with ELC&#39;s Presentation Generator&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="nx">pptx</span><span class="p">.</span><span class="nx">defineSlideMaster</span><span class="p">({</span><span class="w"></span>
<span class="w">        </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Template&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nx">bkgd</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;000000&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nx">objects</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"></span>
<span class="w">            </span><span class="s1">&#39;placeholder&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nx">options</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;body&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;body&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nx">w</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;100%&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nx">h</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;100%&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nx">align</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;center&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nx">fontSize</span><span class="o">:</span><span class="w"> </span><span class="mf">44</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;FFFFFF&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nx">fontFace</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Verdana&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nx">valign</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nx">paraSpaceAfter</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;6&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nx">paraSpaceBefore</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;6&#39;</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}]</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>

<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"></span>

<span class="w">    </span><span class="nx">parseLyrics</span><span class="p">(</span><span class="nx">text</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">verse</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">verse</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;---&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nx">createSlide</span><span class="p">(</span><span class="nx">pptx</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="nx">createSlide</span><span class="p">(</span><span class="nx">pptx</span><span class="p">,</span><span class="w"> </span><span class="nx">verse</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>

<span class="w">    </span><span class="nx">pptx</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="s2">&quot;Presentation - Created with ELCs Presentation Generator&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">function</span><span class="w"> </span><span class="nx">parseLyrics</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[\r\n]{3,}/</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;\n\n&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">function</span><span class="w"> </span><span class="nx">createSlide</span><span class="p">(</span><span class="nx">pptx</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">slide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pptx</span><span class="p">.</span><span class="nx">addNewSlide</span><span class="p">(</span><span class="s1">&#39;Template&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="nx">slide</span><span class="p">.</span><span class="nx">addText</span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">(),</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nx">placeholder</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;body&#39;</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">function</span><span class="w"> </span><span class="nx">clearText</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">function</span><span class="w"> </span><span class="nx">changeLang</span><span class="p">(</span><span class="nx">locale</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">setLanguage</span><span class="p">(</span><span class="nx">locale</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;localized&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;verse1&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;verse2&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;separator&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;verse1&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;verse2&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;verse3&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">},</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span><span class="w"></span>
</code></pre></div>

<h3 id="main-function"><a class="toclink" href="#main-function">Main Function</a></h3>
<p>The <code>createPPT</code> function is the main function which is called whenever the "Generate Presentation" Button is clicked. It performs the following actions:</p>
<ol>
<li>Create the presentation object.</li>
<li>Set the Title.</li>
<li>Define the template</li>
<li>Extract the text</li>
<li>Add each of the slides</li>
<li>Save the file</li>
</ol>
<p>Each of the actions is represented in one of the following lines. To keep it simple, the most complex tasks are explained in further detail below. The methods used for setting the title and saving are self explanatory.</p>
<div class="highlight "><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">createPPT</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">pptx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">PptxGenJS</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="nx">pptx</span><span class="p">.</span><span class="nx">setTitle</span><span class="p">(</span><span class="s2">&quot;Presentation created with ELC&#39;s Presentation Generator&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Template Definition</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Text Extraction</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Add Slide</span><span class="w"></span>

<span class="w">    </span><span class="nx">pptx</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="s2">&quot;Presentation - Created with ELCs Presentation Generator&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<h4 id="template-definition"><a class="toclink" href="#template-definition">Template Definition</a></h4>
<p>In order to achieve a consistent style, a template should be used. In my own experience, black background with white letters gives the best results. To define a Template the method <code>defineSlideMaster</code>. Its parameters corresponds to achieving slides with the following characteristics:</p>
<ul>
<li>Black Background Color: <code>bkgd: '000000'</code></li>
<li>Assing a unique title to use when creating the slide: <code>title: 'Template'</code></li>
<li>Give a unique identifier to a text element inside the slide: <code>name: 'body'</code></li>
<li>Set the coordinates for the text element: <code>x: 0, y: 0,</code></li>
<li>Set the dimensions, both width and height: <code>w: "100%", h: "100%",</code></li>
<li>Use a big font size: <code>fontSize: 44</code></li>
<li>Use White color for the font: <code>color: 'FFFFFF'</code></li>
<li>Center the text horizontally and vertically: <code>align: "center", valign: 'middle',</code></li>
<li>Set paragraph spacing: <code>paraSpaceAfter: '6', paraSpaceBefore: '6'</code></li>
</ul>
<p>When combining all the above and following the syntax provided by the official docs, the results is the following code:</p>
<div class="highlight "><pre><span></span><code><span class="c1">// Template Definition</span><span class="w"></span>
<span class="nx">pptx</span><span class="p">.</span><span class="nx">defineSlideMaster</span><span class="p">({</span><span class="w"></span>
<span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Template&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nx">bkgd</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;000000&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nx">objects</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="w"></span>
<span class="w">        </span><span class="s1">&#39;placeholder&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nx">options</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;body&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;body&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nx">w</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;100%&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nx">h</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;100%&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nx">align</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;center&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nx">fontSize</span><span class="o">:</span><span class="w"> </span><span class="mf">44</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;FFFFFF&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nx">fontFace</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Verdana&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nx">valign</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;middle&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nx">paraSpaceAfter</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;6&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nx">paraSpaceBefore</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;6&#39;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}]</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>

<h4 id="text-extraction"><a class="toclink" href="#text-extraction">Text Extraction</a></h4>
<p>Once the template is defined, the text should be extracted, to achieved this a very common practice is used in JS. Just referenced the element by a given ID and then extract its value. In this case the element is a TextArea defined in HTML5</p>
<p>The resulting code is the following:</p>
<div class="highlight "><pre><span></span><code><span class="c1">// Text Extraction</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"></span>
</code></pre></div>

<h4 id="add-slide"><a class="toclink" href="#add-slide">Add Slide</a></h4>
<p>After extracting the text, it should be parsed and then a new slide should be added for each verse.</p>
<p>The parsing function returns a list of strings, each being either a verse or a <code>---</code> which basically mean "Empty Slide". Both the <code>parseLyrics</code> and the <code>createSlide</code> are explained below.</p>
<div class="highlight "><pre><span></span><code><span class="c1">// Add Slide</span><span class="w"></span>

<span class="nx">parseLyrics</span><span class="p">(</span><span class="nx">text</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">verse</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">verse</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;---&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nx">createSlide</span><span class="p">(</span><span class="nx">pptx</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="nx">createSlide</span><span class="p">(</span><span class="nx">pptx</span><span class="p">,</span><span class="w"> </span><span class="nx">verse</span><span class="p">);</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>

<h3 id="parsing"><a class="toclink" href="#parsing">Parsing</a></h3>
<p>One would never know what the user would write, and, in order to support several languages (specially those with special characters), it is important to use a separator that works universally, in this case the blank line will separate two verses and the three dashes (---) will separate songs.</p>
<p>In order to ignore several blank lines and then split a regular expression and then the <code>split</code> method is used.</p>
<div class="highlight "><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">parseLyrics</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[\r\n]{3,}/</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;\n\n&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<h3 id="create-slide"><a class="toclink" href="#create-slide">Create Slide</a></h3>
<p>Each slide will have a different text so to create a slide one should provide the engine (in this case the library <code>pptx</code>) and the text to be inserted (the <code>text</code> argument), then the new slide is created using the predefined template, after that the text in upper case is added using the placeholder defined in the template.</p>
<div class="highlight "><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">createSlide</span><span class="p">(</span><span class="nx">pptx</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">slide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pptx</span><span class="p">.</span><span class="nx">addNewSlide</span><span class="p">(</span><span class="s1">&#39;Template&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="nx">slide</span><span class="p">.</span><span class="nx">addText</span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">(),</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nx">placeholder</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;body&#39;</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<h3 id="clear-text-button"><a class="toclink" href="#clear-text-button">Clear Text Button</a></h3>
<p>In case the user wants to delete everything in the Lyrics Area, a button is provided, the functionality is overwriting the current content of the TextArea with an empty string.</p>
<div class="highlight "><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">clearText</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<h3 id="localization"><a class="toclink" href="#localization">Localization</a></h3>
<p>This extra feature provides client-side localization via <a href="https://github.com/fabi1cazenave/webL10n" target="_blank">WebL10n</a>, each string of the web app is both available in English and Spanish, but more languages could be added in the future if needed.</p>
<div class="highlight "><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">changeLang</span><span class="p">(</span><span class="nx">locale</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">setLanguage</span><span class="p">(</span><span class="nx">locale</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;localized&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;verse1&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;verse2&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;separator&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;verse1&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;verse2&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;lyrics&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">webL10n</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;verse3&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">},</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
  </section>


  <footer>

<!-- Previous And Next Articles -->
<section class="invisible">
    <h2 data-l10n-id="previous-next">Do not forget to check the previous and next Articles</h2>
        <a class="article__button" href="https://elc.github.io/posts/embed-interactive-notebooks">Embed Interactive Jupyter Notebooks in Static Websites for Free</a>
        <a class="article__button" href="https://elc.github.io/posts/jupyter-publishing">Jupyter Publishing Guide: From Embedded to Book</a>
</section>

<!-- Share -->
<section>
    <h2 class="share-invitation"><span data-l10n-id="share-invitation">Did you like this article? Share it!</span></h2>

    <div class="share">
        

        <a href="http://twitter.com/share?url=https%3A//elc.github.io/posts/online-lyrics-presentation-generator&amp;text=%40ELCWeb%20wrote%20this%20interesting%20article%3A%20Lyrics%20Presentation%20Generator" target="_blank" class="twitter-button"
        onclick="ga('send', 'event', 'Twitter Share', 'click', 'Twitter Share'); return true" >
            <i class="fa fa-twitter"></i>
            Twitter
        </a>

        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A//elc.github.io/posts/online-lyrics-presentation-generator&amp;text=%40ELCWeb%20wrote%20this%20interesting%20article%3A%20Lyrics%20Presentation%20Generator" target="_blank" class="linkedin-button"
        onclick="ga('send', 'event', 'LinkedIn Share', 'click', 'LinkedIn Share'); return true" >
            <i class="fa fa-linkedin"></i>
            LinkedIn
        </a>
    </div>
</section>

<!-- Contribution -->
<section>
    <div class="share">
        <a target="_blank" class="contribute-button" 
        href='https://github.com/ELC/elc.github.io-content/edit/master/blog/2019-online-lyrics.md'
        onclick="ga('send', 'event', 'Contribution', 'click', 'Article Contribution'); return true" 
        data-l10n-id="colaboration-button">
        Found a bug or typo? Submit a PR!
        </a>
    </div>
</section>


<!-- News Letter Subscription -->

<ul class="newsletter-container">
    <li>
        <input class="newsletter-check" type="radio" name="ac" id="a1" />
        <label for="a1" class="newsletter-button" data-l10n-id="newsletter-button">Get notify when a new article is published! Subscribe to the Newsletter</label>
        <section class="newsletter-content">
            <h2>
                <span data-l10n-id="subscribe-options">You can subscribe to the news feed via</span><strong> Feedly </strong>
                <span data-l10n-id="or">or</span><strong> Email</strong>:
            </h2>

            <div class="share">
                <a href='https://feedly.com/i/subscription/feed%2Fhttps%3A%2F%2Ffeeds.feedburner.com%2FELCWEB' target='blank'
                    onclick="ga('send', 'event', 'Feedly Subscribe Button', 'click', 'Newsletter'); return true">
                    <img id='feedlyFollow' src='http://s3.feedly.com/img/follows/feedly-follow-rectangle-flat-big_2x.png' alt='follow us in feedly' width='131' height='56'>
                </a>

                <a class="newsletter-button" target="popupwindow" href="https://feedburner.google.com/fb/a/mailverify?uri=ELCWEB"
                    onclick="window.open('https://feedburner.google.com/fb/a/mailverify?uri=ELCWEB', 'popupwindow', 'scrollbars=yes,width=550,height=450'); ga('send', 'event', 'Email Subscribe Button', 'click', 'Newsletter'); return true" >
                    <i class="fa fa-envelope"></i>
                    Email
                </a>
            </div>
            
            <p>
                <span data-l10n-id="newsletter-feedburner">In case you use another reader, check the full list in the </span>
                <a href="http://feeds.feedburner.com/ELCWEB" target="_blank">FeedBurner Pages</a>
            </p>

        </section>
    </li>
</ul>

<!-- Related Posts -->
<section class="article-related">
    <h2 class="article-related-title" data-l10n-id="related-posts">Related Posts</h2>
        <article class="article-related-post">
          
            <div class="article-related-post-body">
                <h3 class="article-related-post-body-title"><a href="https://elc.github.io/posts/juegos-biblicos/es">Juegos Bíblicos para Jóvenes y Adolescentes</a></h3>
                
                <p class="article-related-post-body-description">Compilado de juegos bíblicos listos para imprimir. Pensados y adaptados para jóvenes y adolescentes que buscan conocer más a Dios.</p>
            </div>
        </article>
</section>

    <!-- Comments -->

  <script src="https://utteranc.es/client.js"
          repo="elc/elc.github.io-content"
          issue-term="title"
          label="Comment"
          theme="github-light"
          crossorigin="anonymous"
          async>
  </script>
  <!-- <div id="disqus_thread"></div>
  <script>    
    var disqus_config = function () {
      this.page.url = 'https://elc.github.io/posts/online-lyrics-presentation-generator';  
      this.page.identifier = 'online-lyrics-presentation-generator';
      this.page.title = 'Lyrics Presentation Generator';
    };
    
    (function() {
      var d = document, s = d.createElement('script');
      
      s.src = 'https://elcgweb.disqus.com/embed.js';
      
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> -->
  </footer>

</article>


<footer class="footer">
    <div class="footer-container">
        <ul class="footer-container__column">
                <li><a href="https://elc.github.io/about/" data-l10n-id="about">About</a></li>
                <li><a href="https://elc.github.io/projects/" data-l10n-id="portfolio">Portfolio</a></li>
                <li><a href="https://elc.github.io/publications.html" data-l10n-id="publications">Publications</a></li>
        </ul>
        <ul class="footer-container__column">
            <li><a href="https://elc.github.io/categories/" data-l10n-id="categories">Categories</a></li>
            <li><a href="https://elc.github.io/tags/" data-l10n-id="tags">Tags</a></li>
        </ul>
        <ul class="footer-container__column">
            <li><a href="https://elc.github.io/archives/" data-l10n-id="archives">Archive</a></li>
 
                    <li><a href="https://elc.github.io/disclaimer.html" data-l10n-id="disclaimer">Disclaimer</a></li>
 
                    <li><a href="https://elc.github.io/donate.html" data-l10n-id="donate">Donate</a></li>
        </ul>
    </div>
    <div class="copyright">
        <span>&copy; 2023 Ezequiel Leonardo Castaño</span>
        <span>  <a href="http://feeds.feedburner.com/ELCWEB">Atom feed <i class="fa fa-rss" aria-hidden="true"></i></a></span>
    </div>
</footer>
    <a href="#topbar" class="back-to-top" aria-label="Back to Top">
      <i class="fa fa-arrow-up"></i>
    </a>

    <script src="https://elc.github.io/theme/js/scripts.js?v=df4f0b1" ></script>


<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y3GBPLEV2K"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-Y3GBPLEV2K');
</script>


<script id="dsq-count-scr" src="https://elcgweb.disqus.com/count.js" async></script>

<script>

  var options = {
    sourceAttribute: "src",
    showCloseButton: true
  };

  new LuminousGallery(document.querySelectorAll(".gallery"), options);
</script>

      <script>
        var omitAds = false;
        if (!omitAds){
          
          let dataType = "text";
          let cssClasses = [];
          let adPosition = "";
          let adOrientation = "";
          
          if (window.matchMedia("(min-width: 1500px)").matches) {
            dataType = "image"
              
            const position = ["fixed", "absolute"];
            const randomPosition = Math.floor(Math.random() * position.length);
            adPosition = position[randomPosition]
            cssClasses.push(`ethical-image--${adPosition}`)
            
            const orientations = ["left", "right"];
            const randomOrientation = Math.floor(Math.random() * orientations.length);
            adOrientation = orientations[randomOrientation]
            cssClasses.push(`ethical-image--${adOrientation}`)
              
            }
            
          let ethicalAd = document.querySelector('[data-ea-keywords]');
          
          ethicalAd.setAttribute("data-ea-publisher", "elcgithubio");
          ethicalAd.setAttribute("data-ea-type", dataType);
          ethicalAd.setAttribute("id", `${dataType}-${adPosition}-${adOrientation}`);
          ethicalAd.parentElement.classList.add(`ethical-${dataType}`)
          ethicalAd.parentElement.classList.add(...cssClasses)

        }
      </script>
      
      <script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>

  </body>

</html>